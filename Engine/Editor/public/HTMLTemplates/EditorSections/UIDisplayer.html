<head>
    <style>
        #DataPanel {
            position: relative;
            margin: 0px;
            height: 100%;
            width: 100%;
            padding: 0px;
            border-radius: 0px;
            overflow: hidden;
        }
        #DatapanelHeadBar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: absolute;
            padding-left: 15px;
            padding-right: 15px;
            top:0px;
            width: 100%;
            margin-top: 0px;
            margin-bottom: 0px;
            background-color: #2e2e2e;
            border-radius: 5px;
            border-bottom-left-radius: 0px;
            border-bottom-right-radius: 0px;
            height: 5vh;
        }
        #UIName {
            display: inline-block;
        }
        #DatapanelRight {
            display: flex;
            gap:10px;
            align-items: center;
            padding-right: 25px;
        }
        .centerUIPanel {
            width: 100%;
            height:100%;
            margin-top: 5vh;
            display: flex;
            background-color: black;
        }
        #HTMLCoding {
            width: 30%;
            height: 100%;
            background-color: rgb(20, 20, 20);
            padding: 10px;
            overflow: auto;
        }
        #HTMLDisplay {
            flex-grow: 1;
            height: 100%;
            overflow: auto;
            background-color: #2a2a2a;
            padding: 5px;
            position: relative;
        }
    </style>
    <link rel="stylesheet" href="/GeneralStyles.css" />
</head>

<!-- Note: This is designed to be opened in a fresh window! -->
<div id="DataPanel" class="EditorPanel">
    <div id="DatapanelHeadBar">
        <h2 id="UIName">Some UI</h2>
        <div>
            <button id="minimizeEditor">Minimize Editor</button>
            <button id="minimizePreview">Minimize Preview</button>
            <select id="resolutionDropdown">
                <option value="1920x1080">1920x1080</option>
                <option value="1280x720">1280x720</option>
                <option value="800x600">800x600</option>
                <!-- Add more resolutions as needed -->
            </select>
            <button id="seperatePreview">Seperate Preview</button>
        </div>
        <div id="DatapanelRight">
            <p style="color: #505050; display: inline-block; margin-right: 10px;">Close and re-open this window to cancel all changes</p>
            <button id="UISave" style="display: inline-block; font-size: large; height: 100%;">Save UI</button>
        </div>
    </div>

    <div class="centerUIPanel">
        <div id="HTMLCoding">

        </div>
        <div id="HTMLDisplay">
            
        </div>
    </div>

</div>

<script>
    fetch("GeneralFunctions.js")
        .then(response => response.text())
        .then(data => {
            var scr = document.createElement("script");
            scr.innerHTML = data;
            document.body.appendChild(scr);

            FetchInjectAdditionalHTML("/Toast-Notification");
            FetchInjectAdditionalHTML("Context-Menu");
        });

    const previewElement = document.getElementById("HTMLDisplay");
    document.getElementById('resolutionDropdown').addEventListener('change', function(e) {
        changeResolution(e.target.value);
    });
    function changeResolution(resolution) {
        const [width, height] = resolution.split('x');

        // Set the width and height based on the selected resolution
        previewElement.style.width = `${width}px`;
        previewElement.style.height = `${height}px`;
    }
    changeResolution("1980x1020");

    const editor = document.getElementById("HTMLCoding");
    document.getElementById("minimizeEditor").addEventListener('click',minimizeEditor);
    function minimizeEditor() {
        if(editor.style.display === "none") {
            editor.style.display = "block";
        } else {
            editor.style.display = "none";
        }
    }

    document.getElementById("minimizePreview").addEventListener('click',minimizePreview);
    function minimizePreview() {
        if(previewElement.style.display === "none") {
            previewElement.style.display = "block";
        } else {
            previewElement.style.display = "none";
        }
    }

    var previewWindow;
    document.getElementById("seperatePreview").addEventListener('click',seperatePreview);
    function seperatePreview() {
        previewWindow = window.open("", "HTMLPreview_"+Date.now(), `width=${previewElement.style.width},height=${previewElement.style.width}`);
        document.defaultView.addEventListener('beforeunload', function() {
            if(previewWindow){
                previewWindow.close();
            }
        });
        if (!previewWindow) {
            alert("Unable to open preview window. Please check your popup settings.");
            return;
        }
        editor.style.width = "100%";
        previewWindow.document.body.appendChild(previewElement);
    }
</script>
